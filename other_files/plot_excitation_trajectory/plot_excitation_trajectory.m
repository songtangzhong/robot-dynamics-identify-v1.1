%%
dof=7;
wf=0.05*2*pi;
Tf=20;
h=0.1;
opt_x=[-0.00279895, -0.00369596, 0.00564871, 0.00109245, -0.000246243, 0.0730593, 0.0473643, 0.00463439, -0.0283504, -0.0136579, 0.281599, -0.00462878, -0.0065757, 0.00978885, 0.00186288, -0.000447246, 0.110664, 0.0852664, 0.0115758, -0.0490193, -0.0239695, 0.445976, -0.00317263, -0.000968494, 0.00130769, 0.00293854, -0.00010511, 0.0820303, 0.0575971, 0.00449899, -0.0309801, -0.0173602, 0.321848, -0.00825754, 0.0174508, -0.0158511, 0.00702245, -0.000364584, 0.0285865, 0.0254057, -0.00406349, -0.00341061, -0.010713, 0.117582, 0.00288302, -0.00475276, -0.00328919, 0.0103824, -0.00522348, 0.0552883, 0.00769259, 0.0221323, -0.00683316, -0.0219475, 0.192304, 0.0257714, -0.0350257, 0.00452889, 0.0513474, -0.0466219, 0.0791457, 0.0443854, 0.0509077, 0.0230682, -0.0825825, 0.342368, -0.00148522, 0.0243508, -0.039178, -0.0153682, 0.0316806, 0.0312991, 0.0708606, 0.0876792, -0.0343462, -0.0597346, 0.240077];

count=Tf/h;
opt_q=zeros(count+1,dof);
opt_dq=zeros(count+1,dof);
opt_ddq=zeros(count+1,dof);

t=-h;
for k=1:(count+1)
    t=t+h;
    [opt_q(k,:),opt_dq(k,:),opt_ddq(k,:)]=generate_fourier_trajectory(opt_x,wf,t); 
end

time=0:h:Tf;
close all;
figure;
plot(time,opt_q(:,1),time,opt_q(:,2),time,opt_q(:,3),time,opt_q(:,4),time,opt_q(:,5),time,opt_q(:,6),time,opt_q(:,7),'Linewidth',2);
grid on;
legend('$q_{1}$','$q_{2}$','$q_{3}$','$q_{4}$','$q_{5}$','$q_{6}$','$q_{7}$','Interpreter','Latex');

figure;
plot(time,opt_dq(:,1),time,opt_dq(:,2),time,opt_dq(:,3),time,opt_dq(:,4),time,opt_dq(:,5),time,opt_dq(:,6),time,opt_dq(:,7),'Linewidth',2);
grid on;
legend('$\dot{q}_{1}$','$\dot{q}_{2}$','$\dot{q}_{3}$','$\dot{q}_{4}$','$\dot{q}_{5}$','$\dot{q}_{6}$','$\dot{q}_{7}$','Interpreter','Latex');

figure;
plot(time,opt_ddq(:,1),time,opt_ddq(:,2),time,opt_ddq(:,3),time,opt_ddq(:,4),time,opt_ddq(:,5),time,opt_ddq(:,6),time,opt_ddq(:,7),'Linewidth',2);
grid on;
legend('$\ddot{q}_{1}$','$\ddot{q}_{2}$','$\ddot{q}_{3}$','$\ddot{q}_{4}$','$\ddot{q}_{5}$','$\ddot{q}_{6}$','$\ddot{q}_{7}$','Interpreter','Latex');








