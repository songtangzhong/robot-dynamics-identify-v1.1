%%
dof=7;
wf=0.05*2*pi;
Tf=20;
h=0.1;
opt_x=[-0.00482246, -0.00456768, 0.00102052, 0.0131105, -0.0047409, 0.205958, 0.0195509, -0.0245491, -0.0210545, -0.0174388, 0.632796, -0.00280426, -0.0207702, -0.0098303, 0.0502865, -0.0168818, 0.126464, 0.157586, -0.0124916, -0.0333422, -0.0541584, 0.579088, -0.00155694, -0.000976716, 0.00170287, 0.00226018, -0.0014294, 0.0477275, 0.00108311, -0.00296765, -0.00510231, -0.00411631, 0.143816, 0.00448596, -0.025165, 0.0481885, -0.0501268, 0.0226174, 0.185916, -0.136786, 0.057006, -0.0402086, 0.0154947, 0.412438, 0.0576789, -0.123174, 0.0635676, -0.00596299, 0.00789013, 0.223814, -0.0555684, 0.21325, -0.0922852, -0.0766572, 0.728008, -0.00965206, 0.0299591, -0.0138336, -0.00436367, -0.00210968, 0.180873, 0.0775571, -0.105593, -0.00428391, -0.000414322, 0.583461, -0.0673861, 0.102243, 0.0186275, -0.0439592, -0.00952466, 0.354254, -0.0610299, -0.117701, -0.0414609, 0.0573507, 0.909124];

count=Tf/h;
opt_q=zeros(count+1,dof);
opt_dq=zeros(count+1,dof);
opt_ddq=zeros(count+1,dof);

t=-h;
for k=1:(count+1)
    t=t+h;
    [opt_q(k,:),opt_dq(k,:),opt_ddq(k,:)]=generate_fourier_trajectory(opt_x,wf,t); 
end

time=0:h:Tf;
close all;
figure;
plot(time,opt_q(:,1),time,opt_q(:,2),time,opt_q(:,3),time,opt_q(:,4),time,opt_q(:,5),time,opt_q(:,6),time,opt_q(:,7),'Linewidth',2);
grid on;
legend('$q_{1}$','$q_{2}$','$q_{3}$','$q_{4}$','$q_{5}$','$q_{6}$','$q_{7}$','Interpreter','Latex');

figure;
plot(time,opt_dq(:,1),time,opt_dq(:,2),time,opt_dq(:,3),time,opt_dq(:,4),time,opt_dq(:,5),time,opt_dq(:,6),time,opt_dq(:,7),'Linewidth',2);
grid on;
legend('$\dot{q}_{1}$','$\dot{q}_{2}$','$\dot{q}_{3}$','$\dot{q}_{4}$','$\dot{q}_{5}$','$\dot{q}_{6}$','$\dot{q}_{7}$','Interpreter','Latex');

figure;
plot(time,opt_ddq(:,1),time,opt_ddq(:,2),time,opt_ddq(:,3),time,opt_ddq(:,4),time,opt_ddq(:,5),time,opt_ddq(:,6),time,opt_ddq(:,7),'Linewidth',2);
grid on;
legend('$\ddot{q}_{1}$','$\ddot{q}_{2}$','$\ddot{q}_{3}$','$\ddot{q}_{4}$','$\ddot{q}_{5}$','$\ddot{q}_{6}$','$\ddot{q}_{7}$','Interpreter','Latex');








