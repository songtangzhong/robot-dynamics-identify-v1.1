%%
dof=7;
wf=0.05*2*pi;
Tf=20;
h=0.1;
opt_x=[0.0813216, -0.124592, 0.0499866, -0.00948561, 0.00276921, -0.251153, 0.102501, 0.00174894, 0.0105322, -0.000244771, -0.62623, -0.0551404, 0.00985872, 0.0327479, 0.0150122, -0.00247842, 0.287017, 0.0946029, -0.0200028, -0.0522599, -0.0414349, 0.974979, 0.102502, -0.135356, 0.0367172, 0.000210369, -0.00407359, -0.301114, 0.0351995, 0.018363, 0.0317016, 0.00976392, -0.851527, -0.0783217, 0.236056, -0.198398, 0.0352156, 0.00544827, -0.0669617, 0.0594069, -0.0225025, 0.03254, -0.022901, -0.131157, 0.155787, 0.0153624, -0.0910172, -0.21001, 0.129877, 0.0176746, 0.451487, -0.47072, 0.121494, 0.0011068, 0.372761, -0.0475389, 0.0997768, 0.108259, -0.211222, 0.0507248, 0.0200456, 0.00750199, -0.111221, 0.203142, -0.102791, 0.0539545, 0.0865655, -0.227965, -0.19699, 0.609975, -0.271585, -0.032123, 0.198073, 0.282556, -0.595347, 0.233939, 0.187963];
count=Tf/h;
opt_q=zeros(count+1,dof);
opt_dq=zeros(count+1,dof);
opt_ddq=zeros(count+1,dof);

t=-h;
for k=1:(count+1)
    t=t+h;
    [opt_q(k,:),opt_dq(k,:),opt_ddq(k,:)]=generate_fourier_trajectory(opt_x,wf,t); 
end

time=0:h:Tf;
close all;
figure;
plot(time,opt_q(:,1),time,opt_q(:,2),time,opt_q(:,3),time,opt_q(:,4),time,opt_q(:,5),time,opt_q(:,6),time,opt_q(:,7),'Linewidth',2);
grid on;
legend('$q_{1}$','$q_{2}$','$q_{3}$','$q_{4}$','$q_{5}$','$q_{6}$','$q_{7}$','Interpreter','Latex');

figure;
plot(time,opt_dq(:,1),time,opt_dq(:,2),time,opt_dq(:,3),time,opt_dq(:,4),time,opt_dq(:,5),time,opt_dq(:,6),time,opt_dq(:,7),'Linewidth',2);
grid on;
legend('$\dot{q}_{1}$','$\dot{q}_{2}$','$\dot{q}_{3}$','$\dot{q}_{4}$','$\dot{q}_{5}$','$\dot{q}_{6}$','$\dot{q}_{7}$','Interpreter','Latex');

figure;
plot(time,opt_ddq(:,1),time,opt_ddq(:,2),time,opt_ddq(:,3),time,opt_ddq(:,4),time,opt_ddq(:,5),time,opt_ddq(:,6),time,opt_ddq(:,7),'Linewidth',2);
grid on;
legend('$\ddot{q}_{1}$','$\ddot{q}_{2}$','$\ddot{q}_{3}$','$\ddot{q}_{4}$','$\ddot{q}_{5}$','$\ddot{q}_{6}$','$\ddot{q}_{7}$','Interpreter','Latex');








