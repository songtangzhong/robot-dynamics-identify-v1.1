%%
dof=7;
wf=0.02*2*pi;
Tf=20;
h=0.1;
opt_x=[-0.0181265, 0.00177534, 0.0819317, 0.271109, -0.336689, -0.00203889, -0.140084, 0.387169, -0.0259285, -0.155117, 0.154937, -0.025576, 0.058231, -0.0898791, 0.140941, -0.0837172, 0.0149123, 0.00295067, 0.2111, 0.0338518, -0.157904, 0.506403, -0.055972, -0.206539, -0.187232, 0.141792, 0.307951, -0.0305114, 0.118593, 0.0413487, 0.0432841, -0.100771, 0.264473, -0.0889699, 0.0894974, 0.0255538, -0.0861547, 0.0600734, 0.011639, 0.239613, -0.0439233, -0.0434053, -0.0370949, 0.784111, 0.000547826, 0.13559, -0.160224, 0.00632244, 0.0177635, -0.00055921, 0.198038, 0.197595, 0.0065397, -0.202892, 0.997752, -0.121556, 0.177696, 0.0140899, 0.0864697, -0.1567, 0.0819338, -0.0464268, 0.0146641, 0.0633066, -0.0572598, 0.540993, -0.054734, 0.043889, 0.0701873, -0.0685402, 0.0091979, -0.0278863, 0.287798, 0.0873214, -0.10697, -0.0763587, 0.820489];

count=Tf/h;
opt_q=zeros(count+1,dof);
opt_dq=zeros(count+1,dof);
opt_ddq=zeros(count+1,dof);

t=-h;
for k=1:(count+1)
    t=t+h;
    [opt_q(k,:),opt_dq(k,:),opt_ddq(k,:)]=generate_fourier_trajectory(opt_x,wf,t); 
end

time=0:h:Tf;
close all;
figure;
plot(time,opt_q(:,1),time,opt_q(:,2),time,opt_q(:,3),time,opt_q(:,4),time,opt_q(:,5),time,opt_q(:,6),time,opt_q(:,7),'Linewidth',2);
grid on;
legend('$q_{1}$','$q_{2}$','$q_{3}$','$q_{4}$','$q_{5}$','$q_{6}$','$q_{7}$','Interpreter','Latex');

figure;
plot(time,opt_dq(:,1),time,opt_dq(:,2),time,opt_dq(:,3),time,opt_dq(:,4),time,opt_dq(:,5),time,opt_dq(:,6),time,opt_dq(:,7),'Linewidth',2);
grid on;
legend('$\dot{q}_{1}$','$\dot{q}_{2}$','$\dot{q}_{3}$','$\dot{q}_{4}$','$\dot{q}_{5}$','$\dot{q}_{6}$','$\dot{q}_{7}$','Interpreter','Latex');

figure;
plot(time,opt_ddq(:,1),time,opt_ddq(:,2),time,opt_ddq(:,3),time,opt_ddq(:,4),time,opt_ddq(:,5),time,opt_ddq(:,6),time,opt_ddq(:,7),'Linewidth',2);
grid on;
legend('$\ddot{q}_{1}$','$\ddot{q}_{2}$','$\ddot{q}_{3}$','$\ddot{q}_{4}$','$\ddot{q}_{5}$','$\ddot{q}_{6}$','$\ddot{q}_{7}$','Interpreter','Latex');








